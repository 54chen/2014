  <?xml version="1.0" encoding="utf-8"?>
  <feed xmlns="http://www.w3.org/2005/Atom">
    <title><![CDATA[Category: Payments | 五四陈科学院]]></title>
    <link href="https://www.54chen.com/blog/categories/payments/atom.xml" rel="self"/>
    <link href="https://www.54chen.com/"/>
    <updated>2017-12-29T18:10:29+08:00</updated>
    <id>https://www.54chen.com/</id>
    <author>
      <name><![CDATA[54chen]]></name>
    </author>
    <generator uri="http://octopress.org/">Octopress</generator>
  
    
    <entry>
      <title type="html"><![CDATA[、印度、印尼在线支付接入、风控和靠谱度对比]]></title>
      <link href="https://www.54chen.com/blog/2016/12/22/payments/"/>
      <updated>2016-12-22T11:53:25+08:00</updated>
      <id>https://www.54chen.com/blog/2016/12/22/payments</id>
      <content type="html"><![CDATA[<p>近期多半时间在支付相关的业务上，特此记录一下接触到的各家情况，尽可能本着客观公正的态度进行点评（实在受不了的渠道才偏主观，见谅）。
  <br><img src=http://chen54.b0.upaiyun.com/1017/19300534019252134249137429843.jpg><br>
  国内支付不用说，主要是微信、支付宝，另外不得不提到的还有苹果IAP、小米支付。</p>
  
  <p>分几部分， IAP主要在马来西亚、台湾等地使用的人不少（没接当地支付渠道的情况下）。paypal作为海外支付宝的角色，在很多外汇不管制的很方便。印度的话，商务不靠谱程度超乎想象，还是要提一提这几家mobikwiki、paytm。印尼、新马泰地区使用的话，讲一讲coda和doku。</p>
  
  <!--more-->
  
  
  <h2>微信支付</h2>
  
  <p>排名是分先后的，把微信排在第一，表明了在我心中，他的江湖地位已经稳固。</p>
  
  <p><br>1) 接入方面<br></p>
  
  <p>如果是第一次接他们的用户付款，平台、公众平台、商户平台 三个的名字可以搞晕你。特别是当你发现平台的openid和公众账号的openid不是一个的时候，他们的文档会告诉你使用unionid，然后你会SB地发现线上的数据根本就TMD没有unionid，根本就TMD没有unionid！没有unionid！（重复三遍以示重要）然后，你不得不让所有的用户退出登录重新进来。</p>
  
  <p>总结一下三个平台的关系：平台可以得到app里的openid，确认用户的身份; 公众平台可以得到在微信里打开h5的openid，也能确认用户的身份，如果要与前一个身份对应上，需要在平台做关联，然后产生一个相等的unionid; 商户平台和平台、公众平台有绑定关系，绑定后，才能收款的对应关系，然后（注意了！敲黑板！这里是重点！）服务号认证后才可申请微信支付，申请服务费：300元/次，然后（还是重点！）定期会过期，重新交钱。</p>
  
  <p>如果要实现app提现的功能（万能的直播app必备功能），之前有人用公众号发红包的api来实现，但这前提要求先关注公众号。最佳实践还是他们企业付款的api，当然了，这个api推出时间不长，一定要注意两个返回码，一个叫return_code，一个叫result_code，必须两个都是success才是真的成功！（敲黑板！！！）呵呵！</p>
  
  <p>另外一个不得不提的就是，如果你的服务器有ipv6支持，他们的域名dns会各种打圈，以至于请求慢到了5－10秒还不返回，对此参考这篇文章<a href="https://www.54chen.com/blog/2016/06/18/wexin-resolve-slowly/%EF%BC%8C%E6%88%96%E8%80%85%E5%85%B3%E9%97%AD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84ipv6%E3%80%82">https://www.54chen.com/blog/2016/06/18/wexin-resolve-slowly/%EF%BC%8C%E6%88%96%E8%80%85%E5%85%B3%E9%97%AD%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84ipv6%E3%80%82</a></p>
  
  <p><br>2) 坏账<br></p>
  
  <p>微信的欺诈性订单基本没有，有纠纷的也比较少，目测主要是他们的垫付金额比较高，对商家基本无感（双手点赞！）。</p>
  
  <p><br>3) 用户使用方面<br></p>
  
  <p>微信支付因为微信的存在，比支付宝要方便，1000块以下的钱，还是微信方便，国内小R用户大量集中在这里。</p>
  
  <p><br>4) 靠谱度评分<br></p>
  
  <p>综合而言，给个最高分，4.5分（满分5分）。</p>
  
  <h2>支付宝</h2>
  
  <p>江湖上曾经的老大，现在略下降排名，天天搞朋友圈。</p>
  
  <p><br>1) 接入方面<br></p>
  
  <p>中规中举，没毛病。</p>
  
  <p><br>2) 坏账<br></p>
  
  <p>欺诈性订单没有，纠纷也没有，老牌支付，数据积累不少，坏人进不来。</p>
  
  <p><br>3) 用户使用方面<br></p>
  
  <p>大R全在这里，因为微信支付的上限只有3000每天，所以超出额度的大R都会选择支付宝。</p>
  
  <p><br>4) 靠谱度评分<br></p>
  
  <p>4.4，比微信少一分，就因为支付宝最近总在那个圈里瞎JB搞。</p>
  
  <h2>小米支付</h2>
  
  <p>这里要推荐小米应用内支付。</p>
  
  <p><br>1) 接入方面<br></p>
  
  <p><a href="http://dev.xiaomi.com/docs/gameentry/%E6%89%8B%E6%9C%BA&amp;pad%E6%B8%B8%E6%88%8F%E6%8E%A5%E5%85%A5%E6%96%87%E6%A1%A3/%E5%BA%94%E7%94%A8%E5%86%85%E6%94%AF%E4%BB%98SDK/">http://dev.xiaomi.com/docs/gameentry/%E6%89%8B%E6%9C%BA&amp;pad%E6%B8%B8%E6%88%8F%E6%8E%A5%E5%85%A5%E6%96%87%E6%A1%A3/%E5%BA%94%E7%94%A8%E5%86%85%E6%94%AF%E4%BB%98SDK/</a></p>
  
  <p>推荐的点在于，你只要接一个sdk，微信＋支付宝＋小米钱包，全都有了。</p>
  
  <p><br>2) 坏账<br></p>
  
  <p>同前。</p>
  
  <p><br>3) 用户使用方面<br></p>
  
  <p>基本上就是微信＋支付宝＋小米 用户，都适用。</p>
  
  <p><br>4) 靠谱度评分<br></p>
  
  <p>4分，差1分满分，是为了自己家的不要骄傲。</p>
  
  <h2>苹果IAP</h2>
  
  <p>这个渠道很变态又不得不用。</p>
  
  <p><br>1) 接入方面<br></p>
  
  <p>如果app涉及到支付购买虚拟物品，苹果应用商店规定必须使用IAP，否则不通过。</p>
  
  <p>接入的时候，严谨的服务器（注意！不要在客户端验证！）验证步骤是：1.有receipt字段  2.有bundle_id  3.in_app有值  4.有transaction_id  5.有prodution_id 6.bundle_id是本app  7.验transaction_id与app订单号是否相等 8.transaction_id是否使用过  9.订单号里的价格是否相等。（这里是重点！）</p>
  
  <p>另外，一个比较重要的防丢单的地方（又是重点！），因为苹果不提供server to server的notify机制，一旦用户端网络不好的时候，很容易出现钱被扣了没发货的情况。这个时候，客户端要使用ios提供的机制，收到应用的回调，重新向服务器发送check订单的请求。</p>
  
  <p><br>2) 坏账<br></p>
  
  <p>快别提了，苹果的坏账率一度能到96％，\cry～～</p>
  
  <p>如果你的app有提现功能（一般直播类打赏类软件必备功能），自己琢磨怎么风控吧（下次有机会再专门讲这里），否则会血本无归。</p>
  
  <p><br>3) 用户使用方面<br></p>
  
  <p>在大，访问佬服务器，使用体验你可以想象，转菊花打不开什么的是常事。关键服务这么烂，无耻的苹果要分30％的提成！</p>
  
  <p><br>4) 靠谱度评分<br></p>
  
  <p>1分，要不是苹果app store的原因，才不会用这么烂的支付。（希望苹果的员工能看到）</p>
  
  <h2>paypal</h2>
  
  <p>比支付宝还要老牌的国际范支付。</p>
  
  <p><br>1) 接入方面<br></p>
  
  <p>人家有server to server的notify，还是比较靠谱的。</p>
  
  <p>有个查订单的接口，千万不要被坑了，里面有有个叫state的字段，如果订单支付有问题，他们在第二个state字段里不会是completed，千万不要只用第一个state（血泪史！）。</p>
  
  <p>处理问题太慢了，一个被刷的案例，一个多星期还没有人来响应。。。商务找商务，再到开发查问题，损失都已经造成了。你能进得来才是怪事。</p>
  
  <p><br>2) 坏账<br></p>
  
  <p>用他们的支付，老外欺诈的很少，反而是国人在上面捣鼓退单提现挣钱。</p>
  
  <p>paypal的风控体系是完善的，能提前预防一些订单。</p>
  
  <p>然而万能的社会工程学成员，经常会在他们平台提起申诉，要求退款，然后你就会花大量的精力和他们提供证据，证明发货，而他们的审判也不一定会判断成给钱或不给，不可知性很强（这里也是重点，就是说他们的坏账率不固定！）。</p>
  
  <p><br>3) 用户使用方面<br></p>
  
  <p>海外用的人不少，除了个别外汇管制不行。</p>
  
  <p><br>4) 靠谱度评分<br></p>
  
  <p>3分，虽然是老牌的支付，还是没有支付宝牛逼。</p>
  
  <h2> IAB</h2>
  
  <p>这个不起眼的支付，居然可以这样。</p>
  
  <p><br>1) 接入方面<br></p>
  
  <p>这里，没有查询订单接口，没有server to server api。只有一个RSA的验证签名过程。</p>
  
  <p>重点一，一定要在服务器验证，不要在客户端验证，不要把私钥放在客户端。</p>
  
  <p>重点二，客户端代码要混淆（虽然也没啥卵用）。</p>
  
  <p>重点三，android developer网站一定要用英文版，中文的翻译版本不知道是哪年翻译的了，好多东西没有。<a href="https://developer.android.com//play/billing/billing_integrate.html">https://developer.android.com//play/billing/billing_integrate.html</a> 最后一段，讲了要在服务器做的事情（ras x.509 balabala&hellip;）。（大量的单机游戏直接就在本地做这个验证了，这真是一个路不拾遗的好时代～～～）</p>
  
  <p>重点四，漏单处理，客户端要在本地主动查询拥有的货品状态，主动commit，与苹果不同，手工的要多一点。</p>
  
  <p>重点五，注意android市场的版本号不要太低，如果用户在其他渠道拿到一个版本号更大的包，是不能支付成功的！</p>
  
  <p><br>2) 坏账<br></p>
  
  <p>刷的人一大把一大把的，但是，人家牛逼啊，基本都能拦住。</p>
  
  <p>不过不得不说的是，他们48小时可以无条件退款（虽然只有一两次到底几次不知道的机会。。。），机器学习就是牛！！</p>
  
  <p><br>3) 用户使用方面<br></p>
  
  <p>主要是海外有android play商店的地方，国内也有一少部分人用，但是连不上～～（因为）</p>
  
  <p><br>4) 靠谱度评分<br></p>
  
  <p>3.5分，比paypal都要靠谱。</p>
  
  <h2>paytm和mobikwik</h2>
  
  <p>印度人民大开挂。</p>
  
  <p><br>1) 接入方面<br></p>
  
  <p>之前在印度，大家是基本不用银行卡的，\笑cry~~</p>
  
  <p>阿里投资了paytm，是当地最大的，mobikwik是个新出来的。技术接入相对简单，完全继承和学习了支付宝。</p>
  
  <p>接入最大的问题是商务。外国公司是不能直接收他们的货币的，所以很长很长的商务周期后，才能开始接入，很长很长的周期后才能上线（截止发稿前，还是开发测试完成未上线）。</p>
  
  <p>而且，印度人民是不乐意看到app有请求发向的（可以），请自觉怎么。</p>
  
  <p><br>2) 坏账<br></p>
  
  <p>未知。</p>
  
  <p><br>3) 靠谱度评分<br></p>
  
  <p>0分，根据印度人民的不靠谱程度，最低分其实是-1。</p>
  
  <h2>codapay和doku</h2>
  
  <p>印尼和新马泰一带，遍布了华人的足迹。</p>
  
  <p><br>1) 接入方面<br></p>
  
  <p>印尼人民很有意思，线上线下的结合很普遍，他们在线上创建的订单，居然愿意跑一趟711去付现金。</p>
  
  <p>接入来讲，很流行的小额支付主要是靠手机运营商代扣（分成50％以上！）。</p>
  
  <p>稍微大额一点（大于相当人民25块），就会线上创建订单，便利店＋ATM付款了。</p>
  
  <p>codapay集成了一堆的支付方式，要实现的只有计算他们的301地址的签名的一段逻辑（意味着基本没有native的sdk）。</p>
  
  <p><br>2) 坏账<br></p>
  
  <p>他们坏账自己承担（民风纯朴，哪有啥坏账）。</p>
  
  <p><br>3) 靠谱度评分<br></p>
  
  <p>codapay2分，doku 2.1分，他两都是当地的支付商家，doku的接口多一些，多0.1分。</p>
  
  <p><input type="hidden" id="mid" name="mid" value="4055819258140259" /></p>
  ]]></content>
    </entry>
    
  </feed>
